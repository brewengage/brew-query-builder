/*!
 * jQuery QueryBuilder 8.3.0
 * Copyright 2014-2018 Damien "Mistic" Sorel (http://www.strangeplanet.fr)
 * Licensed under MIT (http://opensource.org/licenses/MIT)
 */
!function(a,b){"function"==typeof define&&define.amd?define(["jquery","query-builder"],b):b(a.jQuery)}(this,function($){"use strict";function a(a){var b=/^(equal|not_equal)$/.exec(a.operator),c=/.(\*|\?)/.exec(a.value),d=/^(in|not_in)$/.exec(a.operator);return null!==b&&null!==c?"wildcard":null!==b?"term":null!==d?"terms":"range"}function b(a,b){return"AND"===a&&"not_equal"!==b&&"not_in"!==b&&"is_null"!==b?"must":"AND"!==a||"not_equal"!==b&&"not_in"!=b&&"is_null"!==b?"OR"===a?"should":void 0:"must_not"}var c=$.fn.queryBuilder;c.defaults({ESBoolOperators:{equal:function(a){return a},not_equal:function(a){return a},less:function(a){return{lt:a}},less_or_equal:function(a){return{lte:a}},greater:function(a){return{gt:a}},greater_or_equal:function(a){return{gte:a}},between:function(a){return{gte:a[0],lte:a[1]}},"in":function(a){return a.split(",").map(function(a){return a.trim()})},not_in:function(a){return a.split(",").map(function(a){return a.trim()})},is_null:function(a){return a},is_not_null:function(a){return a}},ESQueryStringQueryOperators:{is_not_null:function(){return"_exists_:"},is_null:function(){return"_missing_:"},contains:function(a){return a},between:function(a){return"["+a[0]+" TO "+a[1]+"]"}}}),c.extend({getESBool:function(c){c=void 0===c?this.getRules():c;var d=this;return function e(c){if(c.condition||(c.condition=d.settings.default_condition),["AND","OR"].indexOf(c.condition.toUpperCase())===-1)throw new Error('Unable to build Elasticsearch bool query with condition "{0}"'.replace("{0}",c.condition));if(!c.rules)return{};var f={};return f.add=function(a,b){this.hasOwnProperty(a)?this[a].push(b):this[a]=[b]},c.rules.forEach(function(g){function h(a){return a.data&&a.data.hasOwnProperty("transform")?window[a.data.transform].call(this,a.value):a.value}function i(b){var e=d.settings.ESBoolOperators[b.operator],f=d.getOperatorByType(b.operator),g={};if(void 0===e)throw new Error('Unknown elasticsearch operation for operator "{0}"'.replace("{0}",b.operator));if(0!==f.nb_inputs){var i={};i[b.field]=e.call(d,h(b)),g[a(b)]=i}return"is_null"!==b.operator&&"is_not_null"!==b.operator||(g={exists:{field:b.field}}),"OR"!==c.condition||"not_equal"!==b.operator&&"not_in"!==b.operator&&"is_null"!==b.operator?g:{bool:{must_not:[g]}}}var j=b(c.condition,g.operator);g.rules&&g.rules.length>0?f.add(j,e(g)):f.add(j,i(g))}),delete f.add,{bool:f}}(c)},getESQueryStringQuery:function(a){a=void 0===a?this.getRules():a;var b=this;return function c(a){if(a.condition||(a.condition=b.settings.default_condition),["AND","OR"].indexOf(a.condition.toUpperCase())===-1)throw new Error('Unable to build Elasticsearch query String query with condition "{0}"'.replace("{0}",a.condition));if(!a.rules)return"";var d="";return a.rules.forEach(function(e,f){function g(c){var d=b.settings.ESQueryStringQueryOperators[c.operator],e=b.getOperatorByType(c.operator),g="";if(void 0===d)throw new Error('Unknown elasticsearch operation for operator "{0}"'.replace("{0}",c.operator));var h="";return 0!==e.nb_inputs?(h+=c.field+":"+d.call(b,c.value),g+=h):0===e.nb_inputs&&(h+=d.call(b,c.value)+c.field,g+=h),a.rules[f+1]?g+" "+a.condition+" ":g}d+=e.rules&&e.rules.length>0?"("+c(e)+")":g(e)}),d}(a)}})});